# HG changeset patch
# User igerasim
# Date 1521321263 25200
# Node ID baac18e216fb47b4cfa04169b3c3de58d667de7c
# Parent  fafb1c983a0b9e2fb2e9600388d87240ac4a50a9
8199547: Exception to Pattern Syntax
Reviewed-by: rriggs

CVE: CVE-2018-2952
Upstream-Status: Backport [http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/rev/baac18e216fb]

Signed-off-by: Jagadeesh Krishnanjanappa <jkrishnanjanappa@mvista.com>
diff -r fafb1c983a0b -r baac18e216fb src/share/classes/java/util/regex/PatternSyntaxException.java
--- jdk_org/src/share/classes/java/util/regex/PatternSyntaxException.java	Thu Mar 01 15:57:35 2018 +0000
+++ jdk/src/share/classes/java/util/regex/PatternSyntaxException.java	Sat Mar 17 14:14:23 2018 -0700
@@ -1,5 +1,5 @@
 /*
- * Copyright (c) 1999, 2008, Oracle and/or its affiliates. All rights reserved.
+ * Copyright (c) 1999, 2018, Oracle and/or its affiliates. All rights reserved.
  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  *
  * This code is free software; you can redistribute it and/or modify it
@@ -113,7 +113,7 @@
         }
         sb.append(nl);
         sb.append(pattern);
-        if (index >= 0) {
+        if (index >= 0 && pattern != null && index < pattern.length()) {
             sb.append(nl);
             for (int i = 0; i < index; i++) sb.append(' ');
             sb.append('^');

